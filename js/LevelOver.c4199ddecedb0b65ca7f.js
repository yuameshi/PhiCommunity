(()=>{var e={4561:(e,t,o)=>{e.exports=o.p+"assets/A15A.bf51.svg"},3718:(e,t,o)=>{e.exports=o.p+"assets/B15B.fe0c.svg"},7100:(e,t,o)=>{e.exports=o.p+"assets/C15C.8cee.svg"},4898:(e,t,o)=>{e.exports=o.p+"assets/F15F.2e2c.svg"},7979:(e,t,o)=>{e.exports=o.p+"assets/S15S.f7d3.svg"},9244:(e,t,o)=>{e.exports=o.p+"assets/V15FC.c4de.svg"},2668:(e,t,o)=>{e.exports=o.p+"assets/V15V.afc0.svg"},50:(e,t,o)=>{e.exports=o.p+"assets/phi15phi.e585.svg"},4489:(e,t,o)=>{"use strict";e.exports=o.p+"assets/LevelOver0.78f9.ogg"},870:(e,t,o)=>{"use strict";e.exports=o.p+"assets/LevelOver1.83d3.ogg"},393:(e,t,o)=>{"use strict";e.exports=o.p+"assets/LevelOver2.d36e.ogg"},124:(e,t,o)=>{"use strict";e.exports=o.p+"assets/LevelOver3.ad57.ogg"}},t={};function o(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,o),s.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e+"../"})(),(()=>{"use strict";var e=o(4489),t=o(870),r=o(393),a=o(124),s=o(50),n=o.n(s),l=o(9244),c=o.n(l),i=o(2668),d=o.n(i),g=o(7979),u=o.n(g),p=o(4561),m=o.n(p),w=o(3718),y=o.n(w),S=o(7100),v=o.n(S),h=o(4898),x=o.n(h);const I={ez:0,hd:1,in:2,at:3};window.addEventListener("DOMContentLoaded",(()=>{document.querySelector("div#avatarBar").addEventListener("click",(e=>{var t=e.target;null==t.classList.toString().match("avatarBar")&&(t=e.target.parentElement),t.classList.toString().match("expand")?t.classList.remove("expand"):t.classList.add("expand")})),null!=window.localStorage.getItem("playerName")&&(console.log("Setting player name: ",window.localStorage.getItem("playerName")),document.querySelector("div#avatarBar").setAttribute("data-name",window.localStorage.getItem("playerName"))),null!=window.localStorage.getItem("playerAvatar")&&(console.log("Setting player avatar: ",window.localStorage.getItem("playerAvatar")),document.querySelector("div#avatarBar").children[0].setAttribute("style",'--avatar: url("'+window.localStorage.getItem("playerAvatar")+'");'));const o=sessionStorage.getItem("play"),s=sessionStorage.getItem("level"),l=I[s],i=parseInt(sessionStorage.getItem("score")),g=sessionStorage.getItem("maxCombo"),p=sessionStorage.getItem("perfect"),w=sessionStorage.getItem("good"),S=sessionStorage.getItem("early"),h=sessionStorage.getItem("bad"),f=sessionStorage.getItem("miss"),b=sessionStorage.getItem("mode");switch(b){case"normal":"true"==sessionStorage.getItem("isNewBest")&&(document.querySelector("#scrollFrame").classList.add("newBest"),document.querySelector("#scrollFrame").setAttribute("data-nb","NEW BEST "+sessionStorage.getItem("prevBest").toString().padStart(7,"0")+" +"+(i-sessionStorage.getItem("prevBest"))));break;case"auto":document.querySelector("#scrollFrame").classList.add("auto");break;case"hyper":document.querySelector("#scrollFrame").classList.add("hyper")}sessionStorage.clear();const L=Math.round((parseInt(p)+.65*parseInt(w))/(parseInt(p)+parseInt(w)+parseInt(h)+parseInt(f)+0)*1e4)/100,R=w-S;var B,q;document.getElementById("retryBtn").addEventListener("click",(()=>{window.actx.close(),location.href="../whilePlaying/index.html?play="+o+"&l="+s})),document.getElementById("backInResultBtn").addEventListener("click",(()=>{window.actx.close(),location.href="../songSelect/index.html"})),0==i&&(console.log("No grade"),B="",q=""),i<699999&&0!=i&&(console.log("Grade: False"),B="F15F",q=x()),7e5<=i&&i<=819999&&(console.log("Grade:C"),B="C15C",q=v()),82e4<=i&&i<=879999&&(console.log("Grade:B"),B="B15B",q=y()),88e4<=i&&i<=919999&&(console.log("Grade:A"),B="A15A",q=m()),92e4<=i&&i<=959999&&(console.log("Grade:S"),B="S15S",q=u()),96e4<=i&&i<=999999&&(console.log("Grade:V"),B="V15V",q=d()),0==h&&0==f&&(console.log("Grade: V wih Full Combo"),B="V15FC",q=c()),1e6<=i&&(console.log("Grade:Phi"),B="phi15phi",q=n()),fetch("https://charts.phicommunity.com.cn/"+o+"/meta.json").then((e=>e.json())).then((n=>{window.window.playResult={score:i,grade:B,gradeURL:q,play:o,playLevel:l,songInfo:n,maxCombo:g,accuracy:L,perFect:p,good:w,bad:h,miss:f,early:S,late:R,playLevelString:s,mode:b},console.log(window.playResult);let c=e;switch(l){case 0:c=e;break;case 1:c=t;break;case 2:c=r;break;case 3:c=a}var d,u;fetch(c).then((e=>e.arrayBuffer())).then((e=>{window.actx=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext),window.actx.decodeAudioData(e,(function(e){var t=window.actx.createBufferSource();t.buffer=e,t.loop=!0,t.connect(window.actx.destination),t.start(0)}))})),document.body.setAttribute("style",`--background:url(${encodeURI("https://charts.phicommunity.com.cn/"+window.playResult.play+"/"+window.playResult.songInfo.illustration)});`),document.querySelector("#songImg").setAttribute("src",encodeURI("https://charts.phicommunity.com.cn/"+o+"/"+window.playResult.songInfo.illustration)),document.querySelector("#score").innerText=i.toString().padStart(7,"0"),fetch(q).then((e=>e.blob())).then((e=>{document.querySelector("#gradeImage").src=URL.createObjectURL(e)})),document.querySelector("#maxCombo").innerText=g,document.querySelector("#accuracy").innerText=L+"%",document.querySelector("#perfect").innerText=p,document.querySelector("#good").innerText=w,document.querySelector("#bad").innerText=h,document.querySelector("#miss").innerText=f,document.querySelector("#early").innerText=S,document.querySelector("#late").innerText=R,document.querySelector("div.songName#songName").innerText=window.playResult.songInfo.name,document.querySelector("div.levelString#levelString").innerText=window.playResult.playLevelString.toUpperCase()+" Lv."+Math.floor(window.playResult.songInfo[window.playResult.playLevelString.toLowerCase()+"Ranking"]||0),d=window.playResult.accuracy>=70?(Math.pow((window.playResult.accuracy-55)/45,2)*(window.playResult.songInfo[window.playResult.playLevelString.toLowerCase()+"Ranking"]||0)).toFixed(2):0,window.playResult.score<88e4&&(u=0),document.querySelector("#rks").innerText=d,console.log("ΔRKS:",d),console.log("ΔData(KB):",u)})).catch((()=>{alert("歌曲信息获取失败！")}))}))})()})();